"use strict";

// Imports
const compare = require("../miscellaneous/compare.js");
const isNegative = require("../miscellaneous/isNegative.js");
const isNumber = require("../miscellaneous/isNumber.js");
const maximum = require("../miscellaneous/maximum.js");
const negative = require("../miscellaneous/negative.js");
const parse = require("../utils/parse.js");
const positive = require("../miscellaneous/positive.js");
const shift = require("../miscellaneous/shift.js");
const trim = require("../utils/trim.js");

/**
 * Subtracts two number-like values
 * @param {string|number} a Number-like value
 * @param {string|number} b Number-like value
 * @returns {string}
 */
function subtract(a, b) {
    if(!isNumber(a) || !isNumber(b)) throw new TypeError("Argument is not a number-like value");
    let na = isNegative(a), nb = isNegative(b), plus = require("./plus.js");
    if(na) return negative(plus(positive(a), positive(b)));
    else if(nb) return plus(a, positive(b));
    else if(compare(a, b) === -1) return negative(subtract(b, a));
    let l = maximum([ parse(a, true)[2].length, parse(b, true)[2].length ]);
    let [ daa, dab ] = [ a, b ].map(v => parse(shift(v, l))[1].split("")), r = "", c = 0;
    while(daa.length || dab.length) {
        let [ da, db ] = [ daa, dab ].map(da => +(da.pop() || "0"));
        if(da - c < db) da += 10;
        r = `${da - c - db}${r}`;
        c = `${da}`.length === 2 ? 1 : 0;
    };
    return trim(shift(r, negative(l)));
};

// Exports
module.exports = subtract;